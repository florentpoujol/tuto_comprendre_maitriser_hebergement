# Les adresses email

Maintenant que vous avez acheté un beau domaine, il va falloir l'utiliser.

Hormis le site web, un domaine trouve son utilité dans la création d'adresse email personnalisées, c'est à dire du type _contact@entreprise.com_ par exemple.

> Pourquoi je m’embêterai pour avoir une telle adresse alors que tous mes clients connaissent déjà mon adresse _entreprise@orange.fr_ ?

Ce n'est bien sûr pas obligatoire, c'est essentiellement une question __d'image de marque_ et d'_habitude_.

Particulièrement si vous avez aussi un site web par exemple, on s'attend à pouvoir vous contacter (l'entreprise et les différents employés si besoin) via une adresse du type _quelquechose@entreprise.com_.

Particulièrement lorsque vous avez besoin de plus d'une seule adresse (une pour la direction, un pour les commerciaux, etc...), cela parait la plupart du temps plus professionnel d'avoir des adresses du genre _fonction@entreprise.com_ (ou _prenom.nom@entreprise.com_) plutôt que _fonction.entreprise@orange.fr_, comme on le voit parfois.

L'essentiel étant que les boites fonctionnent, que vous soyez joignable et que vous puissiez envoyer.

Les informations de cette partie sont génériques et s'appliquent à tous les types de boite email, quelque soit le fournisseur :

- Fournisseurs gratuits comme Gmail,
- Fournisseurs d'Accès à Internet (FAI) comme Orange,
- ou emails liés à un nom domaine personnel via un hébergeur.

# Les types d’adresse email

Lorsque l'on parle d'adresse email, on va d'abord distinguer deux choses :

- Les redirections.
- Les boites.

Une __redirection__ est juste une adresse qui va recevoir un email puis uniquement le faire suivre à une ou plusieurs autres adresses.

Une __boite__ quand à elle est un récipient dans lequel les emails vont pouvoir arriver et être stockés et surtout depuis lequel des emails vont pouvoir être envoyés.

On va ensuite distinguer deux types de boites :

- Les boites basiques.
- Les boites Exchange.

Les boites __basiques__ sont sans doute celles que vous connaissez. Elles ne permettent de ne s'échanger que des emails, via les protocoles __IMAP__, __POP__ et __SMTP__.

Les boites __Exchange__ sont plus évoluées puisqu'elles permettent de s'échanger non seulement des emails, mais aussi des contacts, des calendriers, des rendez-vous et des tâches. Et ce, que ce soit entre plusieurs appareils synchronisés à la même boite ou entre plusieurs boites. Elles s'utilisent avec différentes implémentations du protocole __Exchange ActiveSync__ (MAPI), la plus connue étant sans doute _Microsoft Exchange_.

## Les boites email chez un hébergeur

Même si vous n'avez commandé qu'un seul domaine, il y a toutes les chances que vous puissiez quand même créer au moins une boite email basique (par exemple une boite par Pack Domaine chez 1&1 ou cinq boites par domaine chez Gandi) et plusieurs redirections.

Si vous avez besoin de plus de boite email, mais pas de sites web, vous avez toujours la possibilité de rajouter d'autre boites email, moyennant un coût supplémentaire faible (de l'ordre de quelques euros par mois pour plusieurs boites). Lorsque vous avez un contrat d'hébergement, il y a généralement plusieurs boites email basiques déjà inclus dans les frais d'abonnement.

Dans tous les cas vous pouvez commander en plus des boites Exchange qui sont toujours bien plus onéreuses que les basiques (de l'ordre de 3 à 5 € par mois et par boite).

Toutes les boites sont protégées par un __mot de passe__, ont un __espace de stockage limité__ et peuvent également rediriger automatiquement les emails arrivant vers d'autres adresse (comme une redirection). L'espace de stockage est par exemple de 2 Go chez 1&1 et jusqu'à 5 Go chez OVH et Gandi. Sans pièce jointe, un seul Go est suffisant pour stocker plusieurs milliers d'emails.

## Les fonctionnalités classiques d'une boite email

Avec une boite, même basique, on retrouve la plupart des services classiques (la présence et/ou le coût dépend de l'hébergeur) :

- __Anti-spam__ configurable avec diverses forces, liste blanche et liste noire (j'en reparlerai dans le chapitre sur la résolution des problèmes).
- __Anti-virus__ pour scanner les emails et les pièces jointes.
- __Autorépondeur__ pour envoyer un email de réponse automatiquement à chaque nouvel email arrivant dans la boite, par exemple pour informer que vous partez en vacance.
- __Règles de filtrage__ pour classer automatiquement les emails selon divers critères (expéditeur, sujet, etc...).
- __Alias__ pour pouvoir envoyer depuis une même boite, mais avec des adresses d'expéditeur différentes.
- __Signature__ à rajouter automatiquement à la fin de vos emails.

Mais aussi et surtout :

- Gestion des dossiers d'emails.
- Gestion des contacts.
- Et avec les boites Exchange, gestion des calendriers et des tâches.‌

# Les dossiers d'emails

Typiquement, une boite contient six __dossiers__ dans lesquels vous êtes susceptible de trouver des emails.

__La boite de réception__ : c'est la plupart du temps ici qu'arrive un nouvel email, à moins qu'une règle de filtrage ne l'ai rangé ailleurs ou qu'il n'ai été considéré comme indésirable.

__Les brouillons__ : c'est là que s’enregistre un email en cours de rédaction. Il sera automatiquement supprimé de ce dossier lorsqu'il sera envoyé.

__La boite d'envoi__ : présente uniquement sur les logiciels de messagerie (jamais sur les webmails), c'est là où se range un email entre le moment où vous appuyez sur le bouton envoyer et le moment où l'email est effectivement envoyé par le logiciel. Aujourd'hui cela ne sert vraiment que dans les rares cas où vous n'êtes pas connecté à Internet au moment précis où vous voulez envoyer un email.

__Les objets (ou éléments) envoyés__ : c'est là que les emails effectivement envoyés sont rangés.

__Les spams, ou objets indésirables ou pourriels__ : c'est là que se range par défaut un email jugé comme indésirable par le système anti-spam si il est activé.

__La corbeille__ : c'est là que se range un email que vous souhaitez supprimer. Ce n'est que en vidant la corbeille que l'email sera définitivement supprimé et donc ne comptera plus dans le quota de la boite.

En plus de ces dossiers, vous pouvez en créer autant que vous voulez afin de classer les emails que vous souhaitez conserver.

## Les webmails

Un __webmail__ est un logiciel de messagerie en ligne (comme Gmail) qui est toujours mis à disposition gratuitement. Vous y aurez toujours accès à vos emails même si vous n'êtes pas sur votre ordinateur habituel. Là aussi vous retrouvez sur les webmails modernes toutes les même fonctionnalités classiques de gestion des emails et contacts auxquelles vous vous attendez. 

Vous vous connectez au webmail avec votre adresse email et son mot de passe. Vous ne gérez donc par défaut qu'une seule boite email par connexion. Si vous voulez rentrez dans une autre, vous devez vous déconnecter puis reconnecter à l'autre adresse. Mais tout comme sur n'importe quel logiciel de messagerie, vous pouvez souvent faire en sorte de gérer plusieurs boites à la fois, en vous connectant à une seule d'entre elles.

> __OWA__ ou Outlook Web App est le webmail de Microsoft, notamment utilisé pour les adresses Hotmail/Live et surtout les boites Microsoft Exchange.

L'inconvénient des webmails est qu'il faut avoir constamment Internet, ouvrir un navigateur et de part l'interface web sont parfois limités dans ce que ou comment vous pouvez y faire. Les logiciels de messagerie sont une bonne alternative car la plupart du temps plus pratique à utiliser.

## Les logiciels de messagerie

J'en parle depuis de tout à l'heure, un __logiciel de messagerie__ (ou _client de messagerie_, ou _client email_) est tout simplement un logiciel qui vous permet de gérer vos emails sur votre ordinateur ou appareil mobile (téléphone/tablette).

Vous en connaissez tous :

- __Outlook__ est le logiciel phare de Windows, il n'est pas gratuit mais peut s'acheter seul ou avec la suite Office. Notez que la suite Office est également disponible sous Mac.
- __L'application Courrier__ est installée par défaut sur Windows 10, mais ses fonctionnalités sont basiques.
- __L'application Mail__ (souvent appelée par extension _Mail de Mac_) est le logiciel par défaut sur les Mac.
- __Thunderbird__ est créé par la fondation Mozilla qui édite aussi le navigateur Firefox. Il est gratuit, réputé comme léger et rapide, et fonctionne sur Windows, Mac et Linux.

Tous les appareils mobiles ont également une application email par défaut généralement nommée simplement __Mail__, mais d'autres applications peuvent être téléchargées.

C'est dans les logiciels de messagerie que vous devez __synchroniser__ une ou plusieurs boite email, via les protocoles __POP/IMAP/SMTP/Exchange__.

## La différence POP/IMAP

### SMTP - Simple Mail Transfert Protocol

Retenez juste que c'est pour l'envoi des emails.

POP et IMAP se rapportent eux à la réception ou plus exactement à la récupération des emails par le logiciel sur le __serveur de messagerie entrant__.

### POP - Post Office Protocol

Avec POP, le logiciel se connecte au serveur, puis prend tous les emails contenus dans la boite de réception.

Ensuite, __et suivant la configuration du logiciel__, il va supprimer :

- Tous les emails tout de suite,
- ou seulement les emails vieux de plus de quelques jours/semaines,
- ou rien du tout.

Il n'y a également aucune synchronisation montante, c'est à dire du logiciel vers le serveur. Les emails bougent toujours uniquement du serveur vers le logiciel. Cela signifie que si vous supprimez certains emails du coté de votre logiciel, ou que vous les classez dans différents dossiers, cela n'est pas reproduit du coté du serveur.

Le fait que ce protocole puisse supprimer les emails __sans passer par le dossier corbeille à vider manuellement__ lorsqu'il les récupère signifie aussi que ces emails-là ne __sont plus disponibles pour un autre appareil__ qui irai se connecter par après au serveur.

Si vous avez plusieurs appareils synchronisés à la même boite et que certains emails ne sont reçus que sur un seul de ces postes, c'est un problème de configuration lié à POP qui supprime les emails tout de suite sans les laisser pour les autres.

Attention donc aussi si vous êtes dans cette configuration, les emails de votre boite n'existent que sur votre appareil. Si il lui arrive un souci, vous pouvez perdre tous vos emails.

### IMAP - Internet Message Access Protocol

Avec IMAP, le logiciel se connecte au serveur, puis va synchroniser dans les deux sens (serveur vers logiciel et logiciel vers serveur) tous les __dossiers IMAP__. Ou dit autrement : il va faire en sorte qu'il y ai __la même chose sur votre ordinateur que sur le serveur__ (et vice-versa).

Il télécharge non seulement vers l'ordinateur les emails qu'il n'a pas encore, mais fait également l'inverse. Il téléverse (le bon français pour _uploader_) vers le serveur les emails qui existeraient uniquement sur votre ordinateur mais pas sur le serveur (en dehors du dossier de spam ou de corbeille).

Et lorsque vous déplacez un email de la boite de réception à un autre dossier que vous avez créé par exemple au nom d'un client ou fournisseur, que ce soit sur le serveur ou l'ordinateur, cela est reproduit. IMAP est donc un moyen d'__avoir le même contenu sur tous les appareils synchronisés à la même boite__.

Lorsque vous supprimez un email sur votre ordinateur, il est déplacé vers la corbeille tant sur votre ordinateur que sur le serveur. Mais comme le dossier de la corbeille n'est pas synchronisé avec le serveur, lorsque vous videz celui de votre ordinateur, celui du serveur ne l'est pas. Vous pouvez voir ça comme une sécurité ou un inconvénient, mais cela signifie qu'il faudra aller de temps en temps (une fois pas mois à une fois par an suffit) sur le webmail afin de vider la corbeille et faire redescendre le quota d'email de votre boite.

## La synchronisation d'une boite dans un logiciel de messagerie

Quelque soit le logiciel de messagerie, ce sont les même informations qui seront demandées pour y synchroniser une boite email. Par contre, l'interface change évidement beaucoup entre chaque logiciels.

Dans tous les cas, le logiciel commence par demander le nom d'expéditeur, c'est à dire le nom associé à l'adresse que verra le destinataire, ainsi que l'adresse email, et son mot de passe.

Avec les boites basiques, il faut ensuite choisir le protocole de réception entre POP et IMAP. Il n'est pas possible de le changer une fois choisit, mais vous pourrez toujours supprimer la boite du logiciel pour la reconfigurer depuis le début avec un autre protocole par la suite.

Ensuite, pour la réception comme pour l'envoi, il faut configurer les  paramètres suivants :

### Serveur de réception et d'envoi

Le logiciel doit se connecter à un serveur de réception pour récupérer les emails reçus dans la boite  ainsi qu'à un serveur d'envoi afin de transmettre les emails à envoyer.

Par défaut, le logiciel remplira sans doute les champs avec quelque chose du genre _imap.votredomaine.com_ et _smtp.votredomaine.com_.

Le serveur de réception ne sera la plupart du temps pas vraiment imap.votredomaine.com mais ça peut marcher si le sous-domaine _imap_ existe bien dans la zone DNS du domaine et fait un raccourci (un enregistrement CNAME) vers le vrai nom du serveur, comme c'est le cas chez OVH et Gandi par exemple.

Dans tous les cas, mettez ce que votre hébergeur indique dans leurs tutoriels. Par exemple :

- _ssl0.ovh.net_ pour IMAP, POP et SMTP chez OVH.
- _imap.1and1.fr_, _pop.1and1.fr_ et _auth.smtp.1and1.fr_ chez 1&1.

### Ports et sécurité SSL/TLS

Pour IMAP c'est toujours le port _143 sans sécurité_  ou de préférence le port __993 avec sécurité SSL/TLS__.

Pour POP c'est toujours le port _110 sans sécurité_ ou de préférence le port __995 avec sécurité SSL/TLS__.

Pour SMTP c'est le port _587 sans sécurité_ ou de préférence le port __465 avec sécurité SSL/TLS__.

> Le port 25 est généralement réservé pour le serveur d'envoi de votre FAI.

Dans certains cas, le logiciel choisira tout seul.

> Pourquoi "de préférence" les ports avec la sécurité SSL/TLS ?

Parce que c'est mieux ! Les détails techniques ne sont pas importants pour ce cours, mais de la même manière qu'il est mieux qu'un site web ai une adresse qui commence par _https_, il est mieux de se connecter à aux serveurs d'email avec la sécurité SSL/TLS. Si votre hébergeur ou votre logiciels venaient à ne pas supporter l'utilisation de cette sécurité, changez-en !

### Authentification

Pour éviter que n'importe qui ne puisse récupérer vos emails, le logiciels doit s'authentifier auprès du serveur de réception, exactement de la même manière que vous le faites lorsque vous vous connectez à un webmail.

L'identifiant est donc typiquement soit __l'adresse email au complet__, soit juste __ce qu'il y a devant le arobase__ (@). Le mot de passe est typiquement le même que celui de l'adresse.

Le serveur d'envoi n'a pas forcément besoin d'authentification, mais ça devient très rare, car ça veut dire que n'importe qui peut l'utiliser pour envoyer des emails, et le risque qu'il soit utilisé pour envoyer du spam et donc se fasse blacklisté un peu partout est grand. La majorité du temps, il y a donc besoin d'authentification auprès du serveur d'envoi également. L'identifiant et le mot de passe sont quasiment toujours les même que pour la réception.

### Exchange

Avec les boites Exchange, c'est généralement plus simple puisque le seul paramètre à modifier est la plupart du temps l'adresse du serveur Exchange.

## Limites à l'utilisation des emails

### Poids d'un email

__Les emails ne sont pas fait pour se partager des fichiers__. C'est bien sur pratique de pouvoir s'envoyer des pièces jointe mais chez tous les prestataires il y a une limite au poids total d'un email tant lors de l'envoi que lors de la réception.

Chez 1&1 et OVH vous pouvez envoyer des emails pesant en tout jusqu'à 100 Mo via un client de messagerie. Notez bien que l'email va mettre du temps à partir, suivant la vitesse à laquelle votre connexion Internet vous permet d'uploader des fichiers.

Mais la plupart des prestataires limitent de toute façon la taille totale d'un email reçut à bien mois, souvent __seulement 10 Mo ou à peine plus__.

D'une manière générale, si vos pièces jointes font au total plus de 10 Mo, pensez déjà à les zipper pour réduire leur poid et surtout à utiliser autre chose qu'un email pour les partager, par exemple [WeTransfer](https://wetransfer.com) ou Dropbox. Ce n'est alors que le lien de téléchargement que vous envoyez par email.

### Limites d'envoi

> Les boites emails qu'une manière générale, même les Exchange, même celles dites professionnelles, __ne sont en aucun cas faites pour envoyer des emails en grand nombre__ sur une courte période de temps.

Pour éviter de se faire employer par des spammeurs, les hébergeurs imposent toujours des limitations sur le nombre d'emails qui peuvent être envoyés par boite, par IP, par heure, etc...

Concrètement chez OVH par exemple, la limite est de 200 à 300 destinataires par heure. Avec les boites Exchange, c'est souvent bien moins, de l'ordre de quelques centaines par jour, __ce qui est de toute façon bien suffisant pour une utilisation de tous les jours__.

Si vous envoyez au dessus de ces quotas, vos emails vont s'empiler dans une file d'attente le temps que le système les envoi en respectant les limites ou alors être complètement rejetés. Vous n'avez donc rien d'autre à faire que de réduire le volume d'email que vous envoyez et prendre votre mal en patience.

> Comment dois-je faire alors pour envoyer des emails en masse ?

Vous devez utiliser un service spécialisé, qui utilise un serveur d'envoi sans ces limitations, et propose d'autres services associés, tels que la création d'un email HTML avec un éditeur WYSIWYG, la gestion des contacts, le suivit de l'ouverture de chaque emails, etc...

Si votre hébergeur n'en propose pas, vous pouvez vous tourner vers d'autres fournisseurs, tels que Mailjet ou Mailchimp, par exemple.

> Même en utilisant ces services qui n'ont rien à voir avec votre hébergeur, vous pourrez envoyer ces emails avec une adresse liée à votre domaine. Mais attention, il faudra alors potentiellment mettre à jour votre enregistrement SPF.

### En résumé

- Une __boite__ email peut recevoir et envoyer des emails alors qu'une __redirection__ ne fait que renvoyer les emails reçus vers d'autres adresses.
- Une boite peut être de type __basique__, ne gérant que les emails, ou bien de type __Exchange__ permettant de gérer et partager les emails, les contacts, les calendriers, et les tâches entre plusieurs appareils connectés à la même boite ou entre plusieurs boites du même type.
- Un __webmail__ est un site web qui permet de gérer une boite email via un navigateur web.
- Un __logiciel de messagerie__ est lui installé sur l'ordinateur (ou l'appareil mobile) et permet de gérer une boite généralement de manière __plus pratique__ qu'un webmail et sans devoir forcément disposer tout le temps d'Internet.
- Le protocole __IMAP__ fait une synchronisation des emails du serveur vers l'appareil et vice versa. Il est généralement adapté lorsque vous voulez avoir __plusieurs appareils connectés à la même boite__.
- Le protocole __POP__ ne va que récupérer les emails sur le serveur et éventuellement les supprimer tout de suite ou plus tard.
- N'utilisez __jamais__ vos adresses pour envoyer plus de quelques centaines d'email par jours, à moins d'utiliser un service approprié.
